<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/js/toolbar_view.js - AVA</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="AVA"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.01</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Ava.html">Ava</a></li>
            
                <li><a href="../classes/Ava.Bar.html">Ava.Bar</a></li>
            
                <li><a href="../classes/Ava.BarList.html">Ava.BarList</a></li>
            
                <li><a href="../classes/Ava.BarView.html">Ava.BarView</a></li>
            
                <li><a href="../classes/Ava.Context.html">Ava.Context</a></li>
            
                <li><a href="../classes/Ava.CursorView.html">Ava.CursorView</a></li>
            
                <li><a href="../classes/Ava.Dispatcher.html">Ava.Dispatcher</a></li>
            
                <li><a href="../classes/Ava.LeftnavView.html">Ava.LeftnavView</a></li>
            
                <li><a href="../classes/Ava.Music.html">Ava.Music</a></li>
            
                <li><a href="../classes/Ava.MusicView.html">Ava.MusicView</a></li>
            
                <li><a href="../classes/Ava.Stave.html">Ava.Stave</a></li>
            
                <li><a href="../classes/Ava.StaveView.html">Ava.StaveView</a></li>
            
                <li><a href="../classes/Ava.ToolbarView.html">Ava.ToolbarView</a></li>
            
                <li><a href="../classes/Ava.Utils.html">Ava.Utils</a></li>
            
                <li><a href="../classes/Ava.View.html">Ava.View</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Ava.html">Ava</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src/js/toolbar_view.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Bar View
 * @example
 *      view = Ava.ToolbarView({});
 *
 * @class Ava.ToolbarView
 * @constructor
 * @param {Object} spec
 * @extends Backbone.View
 **/
Ava.ToolbarView = function(spec) {

    var that = {};
    var tmpl = &quot;&quot;;

    tmpl    += &#x27;    &lt;nav class=&quot;navbar navbar-default&quot; role=&quot;navigation&quot;&gt;&#x27;;
    tmpl    += &#x27;        &lt;a class=&quot;navbar-brand&quot; href=&quot;#&quot;&gt;AVA&lt;/a&gt;&#x27;;
    tmpl    += &#x27;        &lt;div class=&quot;btn-group&quot;&gt;&#x27;;
    tmpl    += &#x27;            &lt;button type=&quot;button&quot; class=&quot;btn btn-default navbar-btn&quot; data-toggle=&quot;button&quot; disabled=&quot;disabled&quot;&gt;&#x27;;
    tmpl    += &#x27;                &lt;span class=&quot;glyphicon glyphicon-edit&quot;&gt;&lt;/span&gt;&#x27;;
    tmpl    += &#x27;            &lt;/button&gt;&#x27;;
    tmpl    += &#x27;        &lt;/div&gt;&#x27;;
    tmpl    += &#x27;        &lt;div class=&quot;btn-group&quot;&gt;&#x27;;
    tmpl    += &#x27;            &lt;button type=&quot;button&quot; class=&quot;btn btn-default navbar-btn&quot; disabled=&quot;disabled&quot;&gt;&#x27;;
    tmpl    += &#x27;                undo&#x27;;
    tmpl    += &#x27;            &lt;/button&gt;&#x27;;
    tmpl    += &#x27;            &lt;button type=&quot;button&quot; class=&quot;btn btn-default navbar-btn&quot; disabled=&quot;disabled&quot;&gt;&#x27;;
    tmpl    += &#x27;                redo&#x27;;
    tmpl    += &#x27;            &lt;/button&gt;&#x27;;
    tmpl    += &#x27;        &lt;/div&gt;&#x27;;

    tmpl    += &#x27;        &lt;div class=&quot;btn-group&quot;&gt;&#x27;;
    tmpl    += &#x27;            &lt;button type=&quot;button&quot; class=&quot;btn btn-default navbar-btn&quot; id=&quot;toolbar-btn-add-bar&quot;&gt;&#x27;;
    tmpl    += &#x27;                + BAR&#x27;;
    tmpl    += &#x27;            &lt;/button&gt;&#x27;;
    tmpl    += &#x27;        &lt;/div&gt;&#x27;;

    // durations buttons
    tmpl    += &#x27;    &lt;% _.each([&quot;durs&quot;, &quot;dots&quot;], function(grp) { %&gt;&#x27;;
    tmpl    += &#x27;        &lt;div class=&quot;btn-group&quot; data-toggle=&quot;buttons&quot;&gt;&#x27;;
    tmpl    += &#x27;        &lt;% _.each( dur_btns[grp], function(btn) { %&gt;&#x27;;
    tmpl    += &#x27;            &lt;label class=&quot;btn btn-default navbar-btn&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;&lt;%= btn.name %&gt;&quot; id=&quot;&lt;%= btn.name %&gt;-&lt;%= btn.id %&gt;&quot;&gt;&lt;%= btn.label %&gt;&lt;/label&gt;&#x27;;
    tmpl    += &#x27;        &lt;% }); %&gt;&#x27;;
    tmpl    += &#x27;        &lt;/div&gt;&#x27;;
    tmpl    += &#x27;    &lt;% }); %&gt;&#x27;;

    // Rest
    tmpl    += &#x27;        &lt;div class=&quot;btn-group&quot;&gt;&#x27;;
    tmpl    += &#x27;            &lt;button type=&quot;button&quot; class=&quot;btn btn-default navbar-btn&quot; id=&quot;nav-btn-rest-toggle&quot; data-toggle=&quot;button&quot;&gt;&#x27;;
    tmpl    += &#x27;                &lt;span id=&quot;nav-btn-rest-toggle-img&quot;&gt;R&lt;/span&gt;&#x27;;
    tmpl    += &#x27;            &lt;/button&gt;&#x27;;
    tmpl    += &#x27;        &lt;/div&gt;&#x27;;

    // Accidentals
    tmpl    += &#x27;        &lt;div class=&quot;btn-group&quot; data-toggle=&quot;buttons&quot;&gt;&#x27;;
    tmpl    += &#x27;        &lt;% _.each( accidental_btns, function(btn) { %&gt;&#x27;;
    tmpl    += &#x27;            &lt;label class=&quot;btn btn-default navbar-btn&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;&lt;%= btn.name %&gt;&quot; id=&quot;nav-btn-acd-&lt;%= btn.id %&gt;&quot;&gt;&lt;%= btn.label %&gt;&lt;/label&gt;&#x27;;
    tmpl    += &#x27;        &lt;% }); %&gt;&#x27;;
    tmpl    += &#x27;        &lt;/div&gt;&#x27;;

    tmpl    += &#x27;    &lt;/nav&gt;&#x27;;

    var dur_btns = {
        // duration
        durs: [
            {
                name:   &#x27;toolbar-btn-dur&#x27;,
                id:     &#x27;64&#x27;,
                label:  &#x27;64th&#x27;,
            },
            {
                name:   &#x27;toolbar-btn-dur&#x27;,
                id:     &#x27;32&#x27;,
                label:  &#x27;32th&#x27;,
            },
            {
                name:   &#x27;toolbar-btn-dur&#x27;,
                id:     &#x27;16&#x27;,
                label:  &#x27;16th&#x27;,
            },
            {
                name:   &#x27;toolbar-btn-dur&#x27;,
                id:     &#x27;8&#x27;,
                label:  &#x27;8th&#x27;,
            },
            {
                name:   &#x27;toolbar-btn-dur&#x27;,
                id:     &#x27;4&#x27;,
                label:  &#x27;4th/q&#x27;,
            },
            {
                name:   &#x27;toolbar-btn-dur&#x27;,
                id:     &#x27;2&#x27;,
                label:  &#x27;2nd/h&#x27;,
            },
            {
                name:   &#x27;toolbar-btn-dur&#x27;,
                id:     &#x27;1&#x27;,
                label:  &#x27;1/w&#x27;,
            },
        ],

        dots: [
            {
                name:   &#x27;toolbar-btn-dots&#x27;,
                id:     &#x27;dot&#x27;,
                label:  &#x27;.&#x27;,
            },
            {
                name:   &#x27;toolbar-btn-dots&#x27;,
                id:     &#x27;ddot&#x27;,
                label:  &#x27;..&#x27;,
            },
        ],

        // TODO: Need to figure out what is this about
        // ties: [
        //     {
        //         name:   &#x27;toolbar-btn-tie&#x27;,
        //         id:     &#x27;tie&#x27;,
        //         label:  &#x27;Tie(+)&#x27;,
        //     },
        // ],
    };

    var accidental_btns = [
        {
            name:   &#x27;toolbar-btn-acd&#x27;,
            id:     &#x27;dsharp&#x27;,
            label:  &#x27;X&#x27;,
        },
        {
            name:   &#x27;toolbar-btn-acd&#x27;,
            id:     &#x27;sharp&#x27;,
            label:  &#x27;#&#x27;,
        },
        {
            name:   &#x27;toolbar-btn-acd&#x27;,
            id:     &#x27;natural&#x27;,
            label:  &#x27;natural&#x27;,
        },
        {
            name:   &#x27;toolbar-btn-acd&#x27;,
            id:     &#x27;flat&#x27;,
            label:  &#x27;b&#x27;,
        },
        {
            name:   &#x27;toolbar-btn-acd&#x27;,
            id:     &#x27;dflat&#x27;,
            label:  &#x27;bb&#x27;,
        },
    ];

    var toggle_toolbar_currents = function() {
        Ava.Utils.toggle_button(&#x27;toolbar-btn-dur-&#x27; + Ava.Context.cd());
    };

    var bind_click_to_durs = function() {
        // Douglas Crockford - The Good Parts - p39
        // Populating functions based on variables
        var helper = function(btn_id, dot_id) {
            return function(event) {
                try {
                    // Set current duration
                    Ava.Context.cd(btn_id);
                } catch (e) {
                    console.log(e);
                }
                // reset dot buttons
                Ava.Utils.get_btn_group( dot_id )
                    .button(&#x27;toggle&#x27;);
            };
        };

        // Need to get the first id so that later be able to reach to its parent
        var dot = _.first( dur_btns.dots );
        var dot_element_id = dot.name + &#x27;-&#x27; + dot.id;
        _.each( dur_btns.durs, function(btn, dot) {
            var btn_id = btn.name + &#x27;-&#x27; + btn.id;
            Ava.Utils.bind_click_to_button( btn_id, helper(btn.id, dot_element_id) );
        });
    };

    var set_events = function() {
        // Bind onclick event
        bind_click_to_durs();

        that.$el.find(&#x27;#toolbar-btn-add-bar&#x27;)
            .click( function() { Ava.Dispatcher.trigger( &#x27;toolbar:add_bar&#x27; ); } );
    };

    ( function(spec) {

        var View = Backbone.View.extend({

            template: _.template( tmpl ),

            /**
             * @method render
             **/
            render: function() {
                this.$el.append( this.template({
                    dur_btns:         dur_btns,
                    accidental_btns:  accidental_btns,
                }) );

                // Toggle toolbar keys based on defaults values
                toggle_toolbar_currents();

                set_events();

                return this;
            },

        });

        that = new View(spec);

    })(spec);

    return that;
};

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
